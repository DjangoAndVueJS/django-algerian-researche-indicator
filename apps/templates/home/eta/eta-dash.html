{% extends "layouts/base.html" %}
{%load static %}
{%load tag %}

{% block title %} Dashboard {% endblock %} 

{% block stylesheets %}
<style>
    canvas{
        min-height:200px;
    }
    #partage-dans-pays{
        height: 300px;
    }
</style>
{% endblock stylesheets %}
{% block content %}

{%if user.is_superuser%}
<a href="{%url 'org-etas-liste'%}" class="btn btn-info d-inline-flex align-items-center justify-content-center mb-4">
    <svg class="icon icon-xs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l2.293 2.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
    returner a la liste
</a>
{%endif%}
<div class="page-header">
    <div class="row align-items-center">
      <div class="col">
    
        <h3>
            Tableau de Bord De 

            L'etablisment {{eta.nom}}<br></h3>
    </h3>
    <ul class="breadcrumb">
      <li class="breadcrumb-item"><a href="index.html">Etablisment</a></li>
      <li class="breadcrumb-item active">Tableau de Bord</li>
     
    </ul>
     </div>
    </div>
</div>

<div class="row">       
    <div class="col mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div class="row d-block d-xl-flex align-items-center">
                    <div class="col-12 col-xl-5 text-xl-center mb-3 mb-xl-0 d-flex align-items-center justify-content-xl-center">
                        <div class="icon-shape icon-shape-tertiary rounded me-4 me-sm-0">
                            <svg version="1.1" id="Layer_1" width="45px" height="45px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="10px" y="10px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
                                <g><g><path stroke="black" stroke-width="5" d="M495.432,359.148h-51.841v-43.29c0-13.851-11.268-25.119-25.119-25.119H263.98l0.032-52.376h111.704 c4.427,0,8.017-3.589,8.017-8.017v-34.205c0-4.427-3.589-8.017-8.017-8.017h-9.086V92.994h9.086c4.427,0,8.017-3.589,8.017-8.017 V59.324c0-3.388-2.13-6.41-5.321-7.55L258.696,9.018c-1.743-0.623-3.649-0.623-5.393,0L133.587,51.774 c-3.19,1.139-5.32,4.161-5.32,7.55v25.653c0,4.427,3.589,8.017,8.017,8.017h9.086v95.132h-9.086c-4.427,0-8.017,3.589-8.017,8.017 v34.205c0,4.427,3.589,8.017,8.017,8.017h111.694l-0.032,52.376H93.528c-13.851,0-25.119,11.268-25.119,25.119v43.29H16.568 C7.432,359.148,0,366.58,0,375.716v76.96c0,9.136,7.432,16.568,16.568,16.568h34.739v18.171h-9.086 c-4.427,0-8.017,3.589-8.017,8.017c0,4.427,3.589,8.017,8.017,8.017h68.409c4.427,0,8.017-3.589,8.017-8.017 c0-4.427-3.589-8.017-8.017-8.017h-9.086v-18.171h34.739c9.136,0,16.568-7.432,16.568-16.568v-76.96 c0-9.136-7.432-16.568-16.568-16.568H84.443v-43.29c0-5.01,4.076-9.086,9.086-9.086h154.409l-0.032,52.376h-51.763 c-9.136,0-16.568,7.432-16.568,16.568v76.96c0,9.136,7.432,16.568,16.568,16.568h34.739v18.171h-9.086 c-4.427,0-8.017,3.589-8.017,8.017c0,4.427,3.589,8.017,8.017,8.017h68.409c4.427,0,8.017-3.589,8.017-8.017 c0-4.427-3.589-8.017-8.017-8.017h-9.086v-18.171h34.739c9.136,0,16.568-7.432,16.568-16.568v-76.96 c0-9.136-7.432-16.568-16.568-16.568h-51.919l0.032-52.376h154.501c5.01,0,9.086,4.076,9.086,9.086v43.29h-51.841 c-9.136,0-16.568,7.432-16.568,16.568v76.96c0,9.136,7.432,16.568,16.568,16.568h34.739v18.171h-9.086 c-4.427,0-8.017,3.589-8.017,8.017c0,4.427,3.589,8.017,8.017,8.017h68.409c4.427,0,8.017-3.589,8.017-8.017 c0-4.427-3.589-8.017-8.017-8.017h-9.086v-18.171h34.739c9.136,0,16.568-7.432,16.568-16.568v-76.96 C512,366.58,504.568,359.148,495.432,359.148z M85.511,487.416H67.34v-18.171h18.171V487.416z M136.284,375.182 c0.295,0,0.534,0.239,0.534,0.534v76.96c0,0.295-0.239,0.534-0.534,0.534H16.568c-0.295,0-0.534-0.239-0.534-0.534v-76.96 c0-0.295,0.239-0.534,0.534-0.534H136.284z M144.301,76.96V64.973L256,25.08l111.699,39.893V76.96H144.301z M350.597,92.994 v95.132h-18.171V92.994H350.597z M316.393,92.994v95.132h-18.171V92.994H316.393z M282.188,92.994v95.132h-18.171V92.994H282.188z  M247.983,92.994v95.132h-18.171V92.994H247.983z M213.779,92.994v95.132h-18.171V92.994H213.779z M179.574,92.994v95.132h-18.171 V92.994H179.574z M265.086,487.416h-18.171v-18.171h18.171V487.416z M315.858,375.182c0.295,0,0.534,0.239,0.534,0.534v76.96 c0,0.295-0.239,0.534-0.534,0.534H196.142c-0.295,0-0.534-0.239-0.534-0.534v-76.96c0-0.295,0.239-0.534,0.534-0.534H315.858z  M144.301,222.33v-18.171h223.399v18.171H144.301z M444.66,487.416h-18.171v-18.171h18.171V487.416z M495.967,452.677 c0,0.295-0.239,0.534-0.534,0.534H375.716c-0.295,0-0.534-0.239-0.534-0.534v-76.96c0-0.295,0.239-0.534,0.534-0.534h119.716 c0.295,0,0.534,0.239,0.534,0.534V452.677z" /></g></g>
                                <g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>
                            </svg>
                        </div>
                        <div class="d-sm-none">
                            <h2 class="h5">Divisions</h2>
                            <h3 class="fw-extrabold mb-1">{{nbr_divisions}}</h3>
                        </div>
                    </div>
                    <div class="col-12 col-xl-7 px-xl-0">
                        <div class="d-none d-sm-block">
                            <h2 class="h6 text-gray-400 mb-0">Divisions</h2>
                            <h3 class="fw-extrabold mb-2">{{nbr_divisions}}</h3>
                        </div>
                        
                        {% comment %} <div class="small d-flex mt-1">
                            <div>Since last 24 
                                <span class="text-success fw-bolder">22%</span>
                            </div>
                        </div> {% endcomment %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% comment %} Equipes {% endcomment %}
    <div class="col mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div class="row d-block d-xl-flex align-items-center">
                    <div class="col-12 col-xl-5 text-xl-center mb-3 mb-xl-0 d-flex align-items-center justify-content-xl-center">
                        <div class="icon-shape icon-shape-info rounded me-4 me-sm-0">
                            <svg width="30px" height="30px" class="icon" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path></svg>
                        </div>
                    </div>
                    <div class="col-12 col-xl-7 px-xl-0">
                        <div class="d-none d-sm-block">
                            <h2 class="h6 text-gray-400 mb-0">Equipes</h2>
                            <h3 class="fw-extrabold mb-2">{{nbr_equipes}}</h3>
                        </div>
                        
                        {% comment %} <div class="small d-flex mt-1">                               
                            <div>Since last 24 <svg class="icon icon-xs text-danger" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg><span class="text-danger fw-bolder">2%</span></div>
                        </div> {% endcomment %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    {% comment %} cherch {% endcomment %}
    <div class="col mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div class="row d-block d-xl-flex align-items-center">
                    <div class="col-12 col-xl-5 text-xl-center mb-3 mb-xl-0 d-flex align-items-center justify-content-xl-center">
                        <div class="icon-shape icon-shape-success rounded me-4 me-sm-0">
                            <svg width="30px" height="30px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 360 480" style="enable-background:new 0 0 512.002 512.002;" xml:space="preserve">
                                <g><g><path d="M327.991,373.247l-58.371-17.512l-15.501-23.251c-1.222-1.833-3.145-3.083-5.317-3.455 c-0.628-0.108-1.261-0.13-1.888-0.089v-16.759l4.365-3.638c7.841-6.535,13.049-15.685,14.662-25.765l0.998-6.24h6.162 c13.851,0,25.119-11.268,25.119-25.119v-17.102c0-12.299-8.886-22.554-20.574-24.699l3.045-19.031 c2.26-14.121,1.595-28.178-1.964-41.82c1.127-2.757,1.523-5.854,0.999-9.02l-5.804-35.046l33.917-6.463v43.869 c-9.93,3.354-17.102,12.752-17.102,23.8v34.205c0,4.427,3.589,8.017,8.017,8.017h34.205c4.427,0,8.017-3.589,8.017-8.017v-34.205 c0-11.048-7.172-20.446-17.102-23.8V95.185l15.925-3.034c5.727-1.091,9.728-5.925,9.728-11.755c0-5.831-4-10.664-9.728-11.756 L186.997,39.535c-5.242-0.998-10.557-0.998-15.799,0L18.393,68.641c-5.727,1.091-9.728,5.925-9.728,11.756 s4.001,10.664,9.728,11.755l65.765,12.526l-5.807,35.067c-0.524,3.167-0.128,6.264,0.999,9.02 c-3.558,13.643-4.223,27.7-1.964,41.82l3.045,19.032c-11.688,2.146-20.574,12.401-20.574,24.7v17.102 c0,13.851,11.268,25.119,25.119,25.119h6.162l0.998,6.24c1.613,10.08,6.82,19.229,14.662,25.765l4.365,3.638v16.759 c-0.626-0.042-1.259-0.019-1.888,0.089c-2.172,0.372-4.095,1.622-5.317,3.455l-15.501,23.251l-58.371,17.512 C12.091,378.646,0,394.898,0,413.688v34.409c0,13.851,11.268,25.119,25.119,25.119H332.96c13.851,0,25.119-11.268,25.119-25.119 v-34.409C358.079,394.898,345.988,378.646,327.991,373.247z M254.811,362.428l-34.619,48.467l-28.064-22.452l53.351-40.013 L254.811,362.428z M264.861,188.054l-3.383,21.145h-7.018c-0.254,0-0.475-0.181-0.524-0.43l-4.427-22.134 c-1.854-9.273-8.753-16.512-17.472-19.125l32.589-8.28C266.328,168.689,266.414,178.349,264.861,188.054z M187.056,162.396v-41.15 l71.112-13.545l5.741,34.664c0.046,0.277-0.124,0.537-0.395,0.606L187.056,162.396z M275.112,225.464 c4.046,0.917,7.076,4.535,7.076,8.854v17.102c0,5.01-4.076,9.086-9.086,9.086h-3.597L275.112,225.464z M324.944,165.909v26.188 h-18.171v-26.188c0-5.01,4.076-9.086,9.086-9.086C320.868,156.823,324.944,160.899,324.944,165.909z M84.977,260.506 c-5.01,0-9.086-4.076-9.086-9.086v-17.102c0-4.318,3.03-7.935,7.075-8.854l5.606,35.042H84.977z M42.368,80.397l131.829-25.11 c3.252-0.619,6.549-0.62,9.801,0l131.83,25.11l-131.83,25.11c-3.252,0.619-6.549,0.619-9.801,0L42.368,80.397z M171.023,121.224 v41.173l-76.458-19.426c-0.271-0.068-0.441-0.329-0.396-0.605l5.744-34.686L171.023,121.224z M93.218,188.054 c-1.553-9.705-1.466-19.364,0.235-28.823l32.589,8.281c-8.719,2.612-15.618,9.852-17.472,19.125l-4.427,22.135 c-0.049,0.249-0.269,0.429-0.524,0.429h-7.018L93.218,188.054z M107.967,280.246l-8.8-55.014h4.453 c7.871,0,14.704-5.601,16.246-13.318l4.427-22.134c0.847-4.232,4.593-7.304,8.908-7.304h91.676c4.316,0,8.063,3.072,8.908,7.304 l4.427,22.132c1.542,7.717,8.375,13.32,16.246,13.32h4.453l-8.802,55.014c-1,6.252-4.231,11.928-9.094,15.981l-34.32,28.6 c-3.163,2.636-7.173,4.087-11.291,4.087h-29.636c-6.114,0-12.068-2.156-16.766-6.07l-31.942-26.619 C112.198,292.173,108.967,286.497,107.967,280.246z M112.6,348.43l53.351,40.013l-28.064,22.452l-34.619-48.467L112.6,348.43z  M59.858,457.182H25.119c-5.01,0-9.086-4.076-9.086-9.086v-34.409c0-4.596,1.181-8.938,3.278-12.727l34.2,28.501 c4.032,3.361,6.346,8.299,6.346,13.548V457.182z M171.023,457.182H75.891V443.01c0-10.023-4.416-19.451-12.115-25.866 l-32.618-27.182c1.135-0.525,2.31-0.989,3.539-1.356l55.641-16.694l39.422,55.191c1.279,1.791,3.241,2.978,5.421,3.28 c0.367,0.051,0.735,0.076,1.102,0.076c1.81,0,3.579-0.612,5.008-1.757l29.731-23.784V457.182z M127.198,339.336v-13.793 l11.542,9.618c7.572,6.311,17.172,9.786,27.029,9.786h29.636c7.861,0,15.516-2.772,21.555-7.804l13.92-11.6v13.793l-51.841,38.881 L127.198,339.336z M282.188,443.008v14.172h-95.132v-52.265l29.731,23.785c1.429,1.144,3.198,1.757,5.008,1.757 c0.367,0,0.734-0.025,1.102-0.076c2.182-0.302,4.142-1.489,5.421-3.28l39.422-55.191l55.642,16.692 c1.228,0.37,2.404,0.833,3.539,1.357l-32.618,27.182C286.604,423.558,282.188,432.987,282.188,443.008z M342.046,448.096 c0,5.01-4.076,9.086-9.086,9.086h-34.739V443.01c0-5.25,2.313-10.188,6.346-13.548l34.2-28.501 c2.097,3.79,3.278,8.131,3.278,12.727V448.096z" /></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>
                            </svg>
                        </div>
                    </div>
                    <div class="col-12 col-xl-7 px-xl-0">
                        <div class="d-none d-sm-block">
                            <h2 class="h6 text-gray-400 mb-0">Chercheurs</h2>
                            <h3 class="fw-extrabold mb-2">{{nbr_chers}}</h3>
                        </div>
                        
                        {% comment %} <div class="small d-flex mt-1">                               
                            <div>Since last 24H <svg class="icon icon-xs text-success" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg><span class="text-success fw-bolder">{{nbr_chercheur_24}}%</span></div>
                        </div> {% endcomment %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div class="row d-block d-xl-flex align-items-center">
                    <div class="col-12 col-xl-5 text-xl-center mb-3 mb-xl-0 d-flex align-items-center justify-content-xl-center">
                        <div class="icon-shape icon-shape-danger rounded me-4 me-sm-0">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path d="M9.983 3v7.391c0 5.704-3.731 9.57-8.983 10.609l-.995-2.151c2.432-.917 3.995-3.638 3.995-5.849h-4v-10h9.983zm14.017 0v7.391c0 5.704-3.748 9.571-9 10.609l-.996-2.151c2.433-.917 3.996-3.638 3.996-5.849h-3.983v-10h9.983z"/></svg>
                        </div>
                    </div>
                    <div class="col-12 col-xl-7 px-xl-0">
                        <div class="d-none d-sm-block">
                            <h2 class="h6 text-gray-400 mb-0">Citations</h2>
                            <h3 class="fw-extrabold mb-2">{{citations}}</h3>
                        </div>
                        {% comment %} <div class="small d-flex mt-1">                               
                            <div>partage dans l'Algirie
                                <span class="text-success fw-bolder">4%</span></div>
                        </div> {% endcomment %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    
<div class="row">
    <div class="col-12 col-xl-8">
        <div class="row">
            <div class="col-12 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h2 class="fs-5 fw-bold mb-0">Nombre de citations par annees</h2>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="citations-total-graph"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-12 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h2 class="fs-5 fw-bold mb-0">Meilleur 5 chercheurs par citations</h2>
                            </div>
                            <div class="col text-end">
                                <a href="#" class="btn btn-sm btn-info">Liste chercheurs</a>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table align-items-center table-flush">
                            <thead class="thead-light">
                                <tr>
                                    <th class="border-bottom" scope="col">
                                        nom
                                    </th>
                                    <th class="border-bottom" scope="col">Nombre citations</th>
                                    <th class="border-bottom" scope="col">indice H</th>
                                    <th class="border-bottom" scope="col">indice i10</th>
                                    <th class="border-bottom" scope="col">percentage dans etablisement</th>
                                </tr>
                            </thead>
                            <tbody>
                                {%for cher in chers5_citations%}
                                <tr>
                                    <th class="text-primary" scope="row">
                                        {{cher}}
                                    </th>
                                    <td class="fw-bolder text-primary">
                                        {{cher.citations}}
                                    </td>
                                    <td class="fw-bolder text-primary">
                                        {{cher.h_index}}
                                    </td>
                                    <td class="fw-bolder text-primary">
                                        {{cher.i10_index}}
                                    </td>
                                    <td class="fw-bolder text-info">
                                        {%count_percentage citations cher.citations%} 
                                    </td>
                                </tr>
                                {%endfor%}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-12 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h2 class="fs-5 fw-bold mb-0">another chart here </h2>
                            </div>
                            <div class="col text-end">
                                <a href="{%url 'eta-divs-liste' eta_id=eta.id %}" class="btn btn-outline-info">Liste Division</a>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="division-chart"></canvas>
                    </div>
                </div>
            </div> 
            
            <div class="col-12 col-xxl-6 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header border-bottom d-flex align-items-center justify-content-between">
                        <h2 class="fs-5 fw-bold mb-0">Team members</h2>
                        <a href="#" class="btn btn-sm btn-primary">See all</a>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush list my--3">
                            <li class="list-group-item px-0">
                                <div class="row align-items-center">
                                <div class="col-auto">
                                    <!-- Avatar -->
                                    <a href="#" class="avatar">
                                        <img class="rounded" alt="Image placeholder" src="{{ ASSETS_ROOT }}/img/team/profile-picture-1.png">
                                    </a>
                                </div>
                                <div class="col-auto ms--2">
                                    <h4 class="h6 mb-0">
                                        <a href="#">Chris Wood</a>
                                    </h4>
                                    <div class="d-flex align-items-center">
                                        <div class="bg-success dot rounded-circle me-1"></div>
                                        <small>Online</small>
                                    </div>
                                </div>
                                <div class="col text-end">
                                    <a href="#" class="btn btn-sm btn-secondary d-inline-flex align-items-center">
                                        <svg class="icon icon-xxs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg>
                                        Invite
                                    </a>
                                </div>
                                </div>
                            </li>
                            <li class="list-group-item px-0">
                                <div class="row align-items-center">
                                    <div class="col-auto">
                                        <!-- Avatar -->
                                        <a href="#" class="avatar">
                                            <img class="rounded" alt="Image placeholder" src="{{ ASSETS_ROOT }}/img/team/profile-picture-2.jpg">
                                        </a>
                                    </div>
                                    <div class="col-auto ms--2">
                                        <h4 class="h6 mb-0">
                                            <a href="#">Jose Leos</a>
                                        </h4>
                                        <div class="d-flex align-items-center">
                                            <div class="bg-warning dot rounded-circle me-1"></div>
                                            <small>In a meeting</small>
                                        </div>
                                    </div>
                                    <div class="col text-end">
                                        <a href="#" class="btn btn-sm btn-secondary d-inline-flex align-items-center">
                                            <svg class="icon icon-xxs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"></path></svg>
                                            Message
                                        </a>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item px-0">
                                <div class="row align-items-center">
                                    <div class="col-auto">
                                        <!-- Avatar -->
                                        <a href="#" class="avatar">
                                            <img class="rounded" alt="Image placeholder" src="{{ ASSETS_ROOT }}/img/team/profile-picture-3.jpg">
                                        </a>
                                    </div>
                                    <div class="col-auto ms--2">
                                        <h4 class="h6 mb-0">
                                            <a href="#">Bonnie Green</a>
                                        </h4>
                                        <div class="d-flex align-items-center">
                                            <div class="bg-danger dot rounded-circle me-1"></div>
                                            <small>Offline</small>
                                        </div>
                                    </div>
                                    <div class="col text-end">
                                        <a href="#" class="btn btn-sm btn-secondary d-inline-flex align-items-center">
                                            <svg class="icon icon-xxs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"></path></svg>
                                            Message
                                        </a>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item px-0">
                                <div class="row align-items-center">
                                    <div class="col-auto">
                                        <!-- Avatar -->
                                        <a href="#" class="avatar">
                                            <img class="rounded" alt="Image placeholder" src="{{ ASSETS_ROOT }}/img/team/profile-picture-4.jpg">
                                        </a>
                                    </div>
                                    <div class="col-auto ms--2">
                                    <h4 class="h6 mb-0">
                                            <a href="#">Neil Sims</a>
                                    </h4>
                                    <div class="d-flex align-items-center">
                                        <div class="bg-danger dot rounded-circle me-1"></div>
                                        <small>Offline</small>
                                    </div>
                                    </div>
                                    <div class="col text-end">
                                        <a href="#" class="btn btn-sm btn-secondary d-inline-flex align-items-center">
                                            <svg class="icon icon-xxs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"></path></svg>
                                            Message
                                        </a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-12 col-xxl-6 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header border-bottom d-flex align-items-center justify-content-between">
                        <h2 class="fs-5 fw-bold mb-0">Progress track</h2>
                            <a href="#" class="btn btn-sm btn-primary">See tasks</a>
                        </div>
                    <div class="card-body">
                        <!-- Project 1 -->
                        <div class="row mb-4">
                            <div class="col-auto">
                                <svg class="icon icon-sm text-gray-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path></svg>
                            </div>
                            <div class="col">
                                <div class="progress-wrapper">
                                    <div class="progress-info">
                                        <div class="h6 mb-0">Rocket - SaaS Template</div>
                                        <div class="small fw-bold text-gray-500"><span>75 %</span></div>
                                    </div>
                                    <div class="progress mb-0">
                                        <div class="progress-bar bg-success" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Project 2 -->
                        <div class="row align-items-center mb-4">
                            <div class="col-auto">
                                <svg class="icon icon-sm text-gray-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path></svg>
                            </div>
                            <div class="col">
                                <div class="progress-wrapper">
                                    <div class="progress-info">
                                        <div class="h6 mb-0">Themesberg - Design System</div>
                                        <div class="small fw-bold text-gray-500"><span>60 %</span></div>
                                    </div>
                                    <div class="progress mb-0">
                                        <div class="progress-bar bg-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Project 3 -->
                        <div class="row align-items-center mb-4">
                            <div class="col-auto">
                                <svg class="icon icon-sm text-gray-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path></svg>
                            </div>
                            <div class="col">
                                <div class="progress-wrapper">
                                    <div class="progress-info">
                                        <div class="h6 mb-0">Homepage Design in Figma</div>
                                        <div class="small fw-bold text-gray-500"><span>45 %</span></div>
                                    </div>
                                    <div class="progress mb-0">
                                        <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Project 4 -->
                        <div class="row align-items-center mb-3">
                            <div class="col-auto">
                                <svg class="icon icon-sm text-gray-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path></svg>
                            </div>
                            <div class="col">
                                <div class="progress-wrapper">
                                    <div class="progress-info">
                                        <div class="h6 mb-0">Backend for Themesberg v2</div>
                                        <div class="small fw-bold text-gray-500"><span>34 %</span></div>
                                    </div>
                                    <div class="progress mb-0">
                                        <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="34" aria-valuemin="0" aria-valuemax="100" style="width: 34%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 col-xl-4">
        <div class="col-12 px-0 mb-4">
            <div class="card border-0 shadow">
                <div class="card-header d-flex flex-row align-items-center flex-0 border-bottom">
                    <div class="d-block">
                        <h2 class="fs-5 fw-bold mb-0">Nombre de citations par divisions</h2>
                    </div>
                    <div class="col text-end">
                        <a href="{%url 'eta-divs-liste' eta_id=eta.id %}" class="btn btn-sm btn-info">Liste Divisions</a>
                    </div>
                </div>
                <div class="card-body p-2">
                    <div id="partage-dans-pays" class="w-100"></div>
                </div>
            </div>
        </div>
        <div class="col-12 px-0 mb-4">
            <div class="card border-0 shadow">
                <div class="card-body">
                    {% comment %} <div class="d-flex align-items-center justify-content-between border-bottom pb-3">
                        <div>
                            <div class="h6 mb-0 d-flex align-items-center">
                                <svg class="icon icon-xs text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.977 5.977 0 0116 10c0 .34-.028.675-.083 1H15a2 2 0 00-2 2v2.197A5.973 5.973 0 0110 16v-2a2 2 0 00-2-2 2 2 0 01-2-2 2 2 0 00-1.668-1.973z" clip-rule="evenodd"></path></svg>
                                Global Rank
                            </div>
                        </div>
                        <div>
                            <a href="#" class="d-flex align-items-center fw-bold">
                                #755
                                <svg class="icon icon-xs text-gray-500 ms-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            </a>
                        </div>
                    </div> {% endcomment %}
                    <div class="d-flex align-items-center justify-content-between border-bottom py-3">
                        <div>
                            <div class="h6 mb-0 d-flex align-items-center">
                                <svg class="icon icon-xs text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z" clip-rule="evenodd"></path></svg>
                                Classement en Algérie
                            </div>
                            <div class="small card-stats">
                                {{eta.location}}
                                <svg class="icon icon-xs text-success" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
                            </div>
                        </div>
                        <div>
                            <a href="#" class="d-flex align-items-center fw-bold">
                                #1
                                <svg class="icon icon-xs text-gray-500 ms-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            </a>
                        </div>
                    </div>
                    {% comment %} <div class="d-flex align-items-center justify-content-between pt-3">
                        <div>
                            <div class="h6 mb-0 d-flex align-items-center">
                                <svg class="icon icon-xs text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1H8a3 3 0 00-3 3v1.5a1.5 1.5 0 01-3 0V6z" clip-rule="evenodd"></path><path d="M6 12a2 2 0 012-2h8a2 2 0 012 2v2a2 2 0 01-2 2H2h2a2 2 0 002-2v-2z"></path></svg>
                                Category Rank
                            </div>
                            <div class="small card-stats">
                                Computers Electronics > Technology
                                <svg class="icon icon-xs text-success" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
                            </div>
                        </div>
                        <div>
                            <a href="#" class="d-flex align-items-center fw-bold">
                                #11
                                <svg class="icon icon-xs text-gray-500 ms-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            </a>
                        </div>
                    </div> {% endcomment %}
                </div>
            </div>
        </div>
        {% comment %} <div class="col-12 px-0">
            <div class="card border-0 shadow">
                <div class="card-body">
                    <h2 class="fs-5 fw-bold mb-1">Acquisition</h2>
                    <p>Tells you where your visitors originated from, such as search engines, social networks or website referrals.</p>
                    <div class="d-block">
                        <div class="d-flex align-items-center me-5">
                            <div class="icon-shape icon-sm icon-shape-danger rounded me-3">
                                <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11 4a1 1 0 10-2 0v4a1 1 0 102 0V7zm-3 1a1 1 0 10-2 0v3a1 1 0 102 0V8zM8 9a1 1 0 00-2 0v2a1 1 0 102 0V9z" clip-rule="evenodd"></path></svg>
                            </div>
                            <div class="d-block">
                                <label class="mb-0">Bounce Rate</label>
                                <h4 class="mb-0">33.50%</h4>
                            </div>
                        </div>
                        <div class="d-flex align-items-center pt-3">
                            <div class="icon-shape icon-sm icon-shape-purple rounded me-3">
                                <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path></svg>                                        </div>
                            <div class="d-block">
                                <label class="mb-0">Sessions</label>
                                <h4 class="mb-0">9,567</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> {% endcomment %}
    </div>
</div>

{% endblock content %}

{% block javascripts %}
<script>
    const div_citations_total = [{% for div in eta_divs_citations %}{{div.div_citations}},{%endfor%}].reduce((partialSum, a)=> partialSum+a, 0)
    const dif = {{citations|safe}}-div_citations_total
    anychart.onDocumentReady(function () {
        var data = [
            {% for div in eta_divs_citations %}
                {x: '{{div.div}}' , value: {{div.div_citations|safe}} } ,
            {%endfor%}
            {x : 'autre', value: dif ,normal:  {fill: "rgba(71, 181, 255,0.7)"},}
        ];
        console.log(data)
        var chart = anychart.pie(data);
        chart.tooltip(true);
        chart.container("partage-dans-pays");
        //chart.container("container");
        chart.draw();
    });
    

    const citLabels = [{%for item in citations_total_8year.citations%}'{{item.year}}',{%endfor%}]
    const citData ={
        labels: citLabels,
        datasets: [{
            axis: 'y',
            label: 'citations',
            categoryPercentage:0.5,
            barPercentage:2,
            barThickness: 35,
            maxBarThickness: 30,
            minBarLength: 2,
            data:[{% for item in citations_total_8year.citations %}{{item.citations}},{%endfor%}],
            fill: true,
            backgroundColor : ['rgba(0, 67, 255, 0.51)','rgba(71, 181, 255,0.3)','rgba(19, 99, 223,0.6)'],
            borderColor: ['rgb(0, 67, 255)','rgb(71, 181, 255)','rgb(19, 99, 223)'],
            borderWidth:1,
        }]
    }
    const citConfig={
        type : 'bar',
        data : citData,
        options:{
            barPercentage: 0.5,
            scales: {
                y:{
                    beginAtZero:true,
                }
            },
        },
    }
    const citChart = new Chart(
        document.getElementById('citations-total-graph'),
        citConfig
    );

    
    function createSolidChart(max) {
        var gauge = anychart.gauges.circular();
        gauge.background(null);
        gauge.fill(null);
        gauge.stroke(null);
        gauge.padding([30, 0, 0, 0]);
        gauge.title().enabled(true).useHtml(true).padding([0, 0, 15, 0]);
        var axis = gauge.axis().radius(70).width(1).fill(null);
        axis
          .scale()
          .minimum(0)
          .maximum(max)
          .ticks({ interval: 1 })
          .minorTicks({ interval: 1 });
        axis.labels().enabled(false);
        axis.ticks().enabled(false);
        axis.minorTicks().enabled(false);
        var stroke = '0.5 #e5e4e4';
        gauge
          .bar(0)
          .dataIndex(0)
          .radius(70)
          .width(40)
          .fill('#64b5f6')
          .stroke(null)
          .zIndex(5);
        gauge
          .bar(1)
          .dataIndex(1)
          .radius(70)
          .width(40)
          .fill('#F5F4F4')
          .stroke(stroke)
          .zIndex(4);
        gauge
          .label()
          .text('')
          .fontSize(20)
          .hAlign('center')
          .anchor('center')
          .padding(0)
          .zIndex(1);
        return gauge;
      }

</script>
{% endblock javascripts %}
